<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>看完这篇，成为Grafana高手 | Earl Wong</title><meta name="author" content="Earl Wong"><meta name="copyright" content="Earl Wong"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="看完这篇，成为Grafana高手原创 huhuli 腾讯VATeam 2022-09-30 14:08 发表于广东https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s&#x2F;ZhBlCjJVhm0dDSCrJFGtfQ 背景QQ直播前端团队接入腾讯云前端性能监控（RUM）后，对目前的监控能力以及上报数据进行了梳理， 并着手进行了前端性能监控的专项建设，其中监控数据大盘建设是不可或缺的一环。可视化的监控大">
<meta property="og:type" content="article">
<meta property="og:title" content="看完这篇，成为Grafana高手">
<meta property="og:url" content="https://wongearl.github.io/2023/10/31/kubernetes/grafana-dashboard/index.html">
<meta property="og:site_name" content="Earl Wong">
<meta property="og:description" content="看完这篇，成为Grafana高手原创 huhuli 腾讯VATeam 2022-09-30 14:08 发表于广东https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s&#x2F;ZhBlCjJVhm0dDSCrJFGtfQ 背景QQ直播前端团队接入腾讯云前端性能监控（RUM）后，对目前的监控能力以及上报数据进行了梳理， 并着手进行了前端性能监控的专项建设，其中监控数据大盘建设是不可或缺的一环。可视化的监控大">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wongearl.github.io/img/20230818103122.jpg">
<meta property="article:published_time" content="2023-10-31T02:10:19.000Z">
<meta property="article:modified_time" content="2023-10-31T02:50:09.089Z">
<meta property="article:author" content="Earl Wong">
<meta property="article:tag" content="grafana">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wongearl.github.io/img/20230818103122.jpg"><link rel="shortcut icon" href="/img/20230823160932.png"><link rel="canonical" href="https://wongearl.github.io/2023/10/31/kubernetes/grafana-dashboard/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '看完这篇，成为Grafana高手',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-31 10:50:09'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/20230818103122.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/thumbbig-1221433.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Earl Wong"><span class="site-name">Earl Wong</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">看完这篇，成为Grafana高手</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-31T02:10:19.000Z" title="发表于 2023-10-31 10:10:19">2023-10-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-31T02:50:09.089Z" title="更新于 2023-10-31 10:50:09">2023-10-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="看完这篇，成为Grafana高手"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>看完这篇，成为Grafana高手<br>原创 huhuli 腾讯VATeam 2022-09-30 14:08 发表于广东<br><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/ZhBlCjJVhm0dDSCrJFGtfQ">https://mp.weixin.qq.com/s/ZhBlCjJVhm0dDSCrJFGtfQ</a></p>
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>QQ直播前端团队接入腾讯云前端性能监控（RUM）后，对目前的监控能力以及上报数据进行了梳理， 并着手进行了前端性能监控的专项建设，其中监控数据大盘建设是不可或缺的一环。<br>可视化的监控大盘可以清晰明了的观察到各项目运行情况，宏观上能快速进行项目间的横向对比，也可以非常便捷的进行项目各数据维度的详细展示，纵向的分析各指标数据的统计。</p>
<p><img src="/image-30.png" alt="Alt text"></p>
<p>通过对数据大盘支持能力的调研，我们采用Grafana进行了数据大盘的建设。通过搭建Grafana服务，然后添加监控上报数据，最终使得【QQ直播前端监控数据大盘】得以建设完成。</p>
<p>那么什么是Grafana？</p>
<p>Grafana 是一款开源的数据可视化工具，使用Grafana可以非常轻松的将数据转成图表(如下图)的展现形式来做到数据监控以及数据统计。</p>
<p>Grafana官方提供Linux，Windows，MacOS，Docker版本</p>
<p>下载链接:  <a target="_blank" rel="noopener" href="https://grafana.com/get/">https://grafana.com/get/</a></p>
<p>本文将依托建设数据大盘的经验，重点介绍一下Grafana的使用，助力小伙伴们成为Grafana高手。</p>
<h1 id="数据与图表"><a href="#数据与图表" class="headerlink" title="数据与图表"></a>数据与图表</h1><p>数据的可视化都是通过图表为载体的，不同的图表可以将数据进行不同侧重点的展现，要进行数据大盘的建设，首先要对图表有一个简单的了解，这样才能在数据大盘搭建过程中选择合适的图表，合理的进行可视化效果的展示。</p>
<p>认识Grafana的图表<br>✦</p>
<p>Grafana 的图表的选择路径都是 在 Visualization 类目下进行图表的选择</p>
<p><img src="/image-31.png" alt="Alt text"></p>
<h2 id="1-折线图"><a href="#1-折线图" class="headerlink" title="1. 折线图"></a>1. 折线图</h2><p><img src="/image-32.png" alt="Alt text">           </p>
<p>示例图表：Time series</p>
<p>图表配置：Graph styles</p>
<p>a. style: Lines</p>
<p>b. Fill opacity: 3</p>
<p>c. Gradient mode: scheme</p>
<h2 id="2-柱状图"><a href="#2-柱状图" class="headerlink" title="2. 柱状图"></a>2. 柱状图</h2><p><img src="/image-39.png" alt="Alt text">         </p>
<p>示例图表：Time series</p>
<p>图表配置：Graph styles</p>
<p>a. style: Bars</p>
<p>b. Fill opacity: 3</p>
<p>c. Gradient mode: scheme</p>
<h2 id="3-点状图"><a href="#3-点状图" class="headerlink" title="3. 点状图"></a>3. 点状图</h2><p><img src="/image-33.png" alt="Alt text">        </p>
<p>示例图表：Time series</p>
<p>图表配置：Graph styles</p>
<p>a. style: Points</p>
<p>b. Point size: 5</p>
<p>c. Stack series: Normal</p>
<h2 id="4-饼状图"><a href="#4-饼状图" class="headerlink" title="4. 饼状图"></a>4. 饼状图</h2><p><img src="/image-34.png" alt="Alt text">          </p>
<p>示例图表：Pie chart</p>
<h2 id="5-单一状态图"><a href="#5-单一状态图" class="headerlink" title="5. 单一状态图"></a>5. 单一状态图</h2><p><img src="/image-35.png" alt="Alt text">          </p>
<p>示例图表：Stat</p>
<p>图表配置：Graph styles</p>
<p>a. style: Bars</p>
<p>b. Fill opacity: 3</p>
<p>c. Gradient mode: scheme</p>
<h2 id="6-仪表盘"><a href="#6-仪表盘" class="headerlink" title="6. 仪表盘"></a>6. 仪表盘</h2><p><img src="/image-36.png" alt="Alt text">        </p>
<p>示例图表：Gauge</p>
<h2 id="7-表格"><a href="#7-表格" class="headerlink" title="7. 表格"></a>7. 表格</h2><p><img src="/image-37.png" alt="Alt text">         </p>
<p>示例图表：Table</p>
<h2 id="8-文本"><a href="#8-文本" class="headerlink" title="8. 文本"></a>8. 文本</h2><p><img src="/image-38.png" alt="Alt text">           </p>
<p>示例图表：Text（支持Markdown 和 HTML两种格式）</p>
<h2 id="9-…"><a href="#9-…" class="headerlink" title="9. …"></a>9. …</h2><h1 id="数据与图表的搭配"><a href="#数据与图表的搭配" class="headerlink" title="数据与图表的搭配"></a>数据与图表的搭配</h1><h2 id="按照数据格式区分"><a href="#按照数据格式区分" class="headerlink" title="按照数据格式区分"></a>按照数据格式区分</h2><p>✦</p>
<p>柱状图， 折线图， 饼状图的图表都需要数据具有时间序列，用于展示在一定的时间区间或者是连续的时间范围内，单一数据或者多种分类数据的变化趋势，或者是数量占比。</p>
<p>状态图， 表格数据，仪表盘等则对数据没有时间序列要求，状态图，仪表盘可用于进行一些总结性的数据展示，例如速度，温度，进度，完成度等， 表格数据则更适合展示复杂数据或者多维度数据</p>
<h2 id="按照使用意图区分"><a href="#按照使用意图区分" class="headerlink" title="按照使用意图区分"></a>按照使用意图区分</h2><p>✦</p>
<p>数据比较：柱状图，折线图比较合适，可以实现单数据，多种类数据的比较，能清晰看到变化趋势</p>
<p>占比分类：饼图，仪表盘， 单一状态图等比较合适，可以清晰的看到每个数据整体性的占比</p>
<p>趋势比较：折线图，面积图(折线可设置覆盖面积) 等比较合适，能直观展现数据变化</p>
<p>分布类：饼图， 散点图 等比较合适</p>
<h2 id="其他-✦"><a href="#其他-✦" class="headerlink" title="其他      ✦"></a>其他      ✦</h2><p>文字类图表就如同名字含义一样，可用于展示文字相关信息，并且个性化定制程度，灵活性排布支持都非常高（得益于Markdown 和 HTML的强大灵活性）</p>
<p>表格对于日志类型，或者是其他多维度数据展示较为合适，适用于整体性给出一个报表，并且具备排序等公共功能，方便数据快速比较。</p>
<h2 id="数据与图表的添加与扩展"><a href="#数据与图表的添加与扩展" class="headerlink" title="数据与图表的添加与扩展"></a>数据与图表的添加与扩展</h2><p>数据源与图表的扩展Grafana都采用插件的形式，因此我们想要扩展某个类型的数据源或者图表时，都需要先在Grafana插件市场找到目标插件，然后进行安装，如下图代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM grafana/grafana:8.3.1</span><br><span class="line">USER root</span><br><span class="line">RUN grafana-cli plugins install grafana-clickhouse-datasource //数据源插件</span><br><span class="line">RUN grafana-cli plugins install auxmoney-waterfall-panel //图表插</span><br></pre></td></tr></table></figure>



<h2 id="数据源添加"><a href="#数据源添加" class="headerlink" title="数据源添加"></a>数据源添加</h2><p>✦</p>
<p>打开Grafana平台，点击左侧”设置”图标，进入DataSource管理面板。</p>
<p><img src="/image-40.png" alt="Alt text">               </p>
<p>在“Add data source”面板中选择合适的数据源，并配置数据库信息。下图以Promethrus为例，添加数据源需要进行必要的配置，例如数据源的ip，port以及鉴权信息等。</p>
<p><img src="/image-41.png" alt="Alt text">         </p>
<p><img src="/image-42.png" alt="Alt text">        </p>
<h2 id="图表插件添加"><a href="#图表插件添加" class="headerlink" title="图表插件添加"></a>图表插件添加</h2><p>✦</p>
<ol>
<li>打开Grafana平台，点击左侧”设置”图标，进入Plugins管理面板</li>
</ol>
<p> <img src="/image-43.png" alt="Alt text">          </p>
<ol start="2">
<li>在tab 栏筛选已经安装的插件，就可以看到已经安装可以使用的插件</li>
</ol>
<p><img src="/image-44.png" alt="Alt text"></p>
<ol start="3">
<li>图表面板已经安装，可以直接在创建面板的时候指定类型使用</li>
</ol>
<p><img src="/image-45.png" alt="Alt text">       </p>
<h1 id="Grafana入门使用"><a href="#Grafana入门使用" class="headerlink" title="Grafana入门使用"></a>Grafana入门使用</h1><p>这里需要区分两个概念：</p>
<p>看板（dashboard）: 一个或多个数据图表形成的集合</p>
<p>面板（panel）：组成看板的其中一个图表</p>
<h2 id="创建一个看板-dashboard"><a href="#创建一个看板-dashboard" class="headerlink" title="创建一个看板 (dashboard)"></a>创建一个看板 (dashboard)</h2><p>✦</p>
<p>创建一个数据可视化看板的前提是需要有数据源的接入， 具体具体接入方法见数据与图表的添加与扩展</p>
<ol>
<li>打开Grafana平台，点击左侧”加号”，点击Create类目下的Dashboard 按钮，新创建一个空表的看板， 会默认弹出四个添加panel的选项</li>
</ol>
<p><img src="/image-46.png" alt="Alt text"><br><img src="/image-47.png" alt="Alt text"></p>
<p>a.添加一个空白面板</p>
<p>b. 添加一个新的行，用于面板的分类</p>
<p>c. 从面板库添加一个面板</p>
<p>d. 从剪贴板添加一个面板，可以用来快速复制一个已有的面板</p>
<ol start="2">
<li>点击看板右上角保存看板。<br><img src="/image-48.png" alt="Alt text"><br>a. 输入看板名称</li>
</ol>
<p>b. 输入简单描述文字</p>
<p>c. 选择看板所属目录（用来分类管理看板）</p>
<p>d. 可选为看板设置Tag，标记看板的特征，后期可根据Tag来筛选看板</p>
<p>e. 其他选项可按需自主定义</p>
<h2 id="创建面板-panel"><a href="#创建面板-panel" class="headerlink" title="创建面板 (panel)"></a>创建面板 (panel)</h2><p>✦</p>
<p><img src="/image-50.png" alt="Alt text">         </p>
<p>点击上图所示的图表，会弹出创建面板的四种选择，可以根据自己的需求自主创建，下面我们以创建空白面板为例</p>
<p>点击Add a new panel 按钮， 你就会创建一个空白数据的图表面板，如下图</p>
<p><img src="/image-51.png" alt="Alt text"></p>
<h2 id="面板数据的获取"><a href="#面板数据的获取" class="headerlink" title="面板数据的获取"></a>面板数据的获取</h2><p>前文已经提到， 创建一个数据可视化看板的前提是需要有数据源的接入，因此，我们想要获取数据，必须要进行数据源的接入</p>
<ol>
<li><p>选择数据源（Data source）<br><img src="/image-52.png" alt="Alt text"><br> 配置选择自己接入的数据源后，后续才能进行相关数据获取的语法编写，这里不同的数据源之前需要的语法也不一样，因此大家可以自己根据自己的条件自主选择， 因为QQ直播接入的数据源是influxdb, 因此后面的例子将会以influxdb语法为例。</p>
</li>
<li><p>SQL语句的编写</p>
</li>
</ol>
<p>Grafana的面板语法编辑有两种形式， 简易模式与高级模式</p>
<p>Grafana 一个面板支持多条SQL语句</p>
<p>a. 简易模式：简易模式数据的获取主要通过下拉框的形式选择具体的指标以及判断条件， 支持添加多个条件</p>
<p><img src="/image-53.png" alt="Alt text">   </p>
<p>高级模式：通过点击编辑图标可以进行编辑模式的切换，高级模式下为全部的SQL语句的编书写，此模式对于语法有一定的要求，但是获取数据会更加的灵活</p>
<p><img src="/image-54.png" alt="Alt text"></p>
<h2 id="面板的基础配置"><a href="#面板的基础配置" class="headerlink" title="面板的基础配置"></a>面板的基础配置</h2><p>在编辑完成数据获取的SQL语句之后，面板上应该已经有了相关数据的展示，此时可以根据自己的数据格式，以及展示诉求来选择对应的图表，图表具体选择参考上文数据与图表的搭配</p>
<p>我们以默认的Time series的折线图为例，简述一下面板的基础配置</p>
<p><img src="/image-55.png" alt="Alt text"></p>
<ol>
<li>面板的基础信息</li>
</ol>
<p><img src="/image-56.png" alt="Alt text">      </p>
<p>在通过SQL语句选择加载完成数据后，图表会有默认的样式给到我们，此时如果对面板无其他要求，只需配置一下面板的基础信息就可完成Grafana的看板配置</p>
<p>基础信息包括</p>
<p>a. 标题</p>
<p>b. 描述</p>
<p>c. 背景是否透明</p>
<ol start="2">
<li>数据提示</li>
</ol>
<p><img src="/image-57.png" alt="Alt text">        </p>
<p>Tootip配置项用于配置当鼠标经过（hover）图表数据点的时候的提示信息， 可选为Single单个提醒， All显示所有数据， Hidden都不显示</p>
<p><img src="/image-58.png" alt="Alt text"></p>
<ol start="3">
<li>图例（legend）显示设置</li>
</ol>
<p><img src="/image-59.png" alt="Alt text"></p>
<p>图例显示模式有三种</p>
<p>a. List (默认)， 图例数据横向依次展示</p>
<p>b. Table， 图例数据会按照表格形式展示</p>
<p>c. Hidden, 不展示图例</p>
<p>图例的位置</p>
<p>a. Bottom, 陈列在图表底部</p>
<p>b. Right, 陈列在图表的右侧</p>
<p> 图例值展示</p>
<p><img src="/image-60.png" alt="Alt text">      </p>
<p>此处会有一个下拉列表供我们选择图例的显示数据，默认不展示，用户也可以选择数据展示形式，例如最大值，最小值，平均值等</p>
<ol start="4">
<li>坐标轴（Axis）配置</li>
</ol>
<p><img src="/image-61.png" alt="Alt text">         </p>
<p>坐标轴的基础配置一般只需要设置一下坐标轴的名称（Label）即可，其余的设置可以按照默认值不用修改，下面简述一下配置的含义</p>
<p>a. Width选项可以选择设置坐标轴（Label）的占比宽度</p>
<p>b. Soft min 以及 Soft max 用来设置纵坐标的显示的最大值最小值</p>
<p>c. Show gride lines 可以设置是否显示背景的网格线</p>
<p>d. Scale 用来设置是否进行数据的放大，目的是让数据对比更加清晰</p>
<p>通过以上对一个图表面板的基础配置，我们的一个图表基本上已经成型，可以达到数据可视化的正常显示目的，剩下的就是加强对自己数据格式类型的分析以及基于自己的可视化诉求来进行合适的图表面板的配置选择，就可以通过多个图表的添加来完成自己初版的数据可视化看板。</p>
<h1 id="Grafana进阶使用"><a href="#Grafana进阶使用" class="headerlink" title="Grafana进阶使用"></a>Grafana进阶使用</h1><p>当我们选择一个图表插件进行数据可视化的时候，图表的一些属性会帮我们设置好了默认值，但是基于兼容性更广的特性，这些默认值也许并不是我们选择图表最合适的展示效果，因此为了进一步提升图表的展示性，我们可以通过以下属性来进行面板的进一步美化。</p>
<h2 id="图表属性配置-Standard-options"><a href="#图表属性配置-Standard-options" class="headerlink" title="图表属性配置 (Standard options)"></a>图表属性配置 (Standard options)</h2><p>✦</p>
<p><img src="/image-62.png" alt="Alt text">              </p>
<p>此选项框中的属性配置，可以使得我们的数据展示更加的准确，例如纵坐标的单位，我们不想采用通用意义上的在Label上进行命名标注单位例如耗时（ms）, 那么就可以选择此处的单位属性（Unit）进行更精确的展示</p>
<ol>
<li>单位（Unit）</li>
</ol>
<p><img src="/image-63.png" alt="Alt text">              </p>
<p>在单位选项中， 你可以进行非常精细化的选择，选项框中几乎包含了所有品类用到的单位属性，例如百分比，长度单位，时间单位，角度单位等等</p>
<ol start="2">
<li>显示范围（Min, Max）</li>
</ol>
<p>在Min, Max 选项中，允许用户输入一个数字进行显示范围的限制，那么图表上在显示范围之外的数据将不会在图表中显示，例如我将耗时限制在0~3000范围，那么3000以外的数据将会被隐藏</p>
<p><img src="/image-64.png" alt="Alt text"></p>
<ol start="3">
<li><p>Decimals 选项可以用来设置纵坐标数据的小数点范围</p>
</li>
<li><p>Display Name 选项则可以用来设置图例显示名字，但是由于限制，只能在只有一类数据时比较适用，如果数据类别较多，单纯在此处设置会将全部图例数据覆盖，因此图例的名称最好在SQL语句编写的时候就做好展示。当然后面也会讲有别的方法进行多种图例数据别名的单独设置</p>
</li>
<li><p>图表颜色配置（Color scheme）</p>
</li>
</ol>
<p>一般图表颜色的展示都会有默认值，不过我们想要改变现在图表曲线的颜色分类可以在此处进行设置。</p>
<p><img src="/image-65.png" alt="Alt text"></p>
<p>我们可以选择整体图表的颜色走向或者是颜色分布，但是一般曲线展示的颜色还是会根据数据自己适配，因此如果我们想要改变某一条曲线的颜色，可以直接点击图例前面的颜色icon,进行颜色选择。我们可以根据提供选项进行选择，也可以自定义设置颜色。</p>
<p><img src="/image-66.png" alt="Alt text"></p>
<h2 id="阈值设置-Thresholds"><a href="#阈值设置-Thresholds" class="headerlink" title="阈值设置 (Thresholds)"></a>阈值设置 (Thresholds)</h2><p>✦</p>
<p>有些图表插件是支持设置阈值的， 阈值的设置可以使得我们对数据的合规程度有清晰的对比，能够直观的衡量出当前数据的质量，因此阈值设置也是面板美化展示的一个重要部分</p>
<p><img src="/image-67.png" alt="Alt text">              </p>
<p>如上图示例，我们设置对耗时的图表设置了两个阈值，上图的意义是：</p>
<ul>
<li><p>在3000ms和5000ms设置阈值</p>
</li>
<li><p>3000ms以下将视为健康，颜色标记为绿色</p>
</li>
<li><p>3000ms~5000ms视为亚健康，颜色标记黄色</p>
</li>
<li><p>5000ms以上视为警示，颜色标记为红色</p>
</li>
</ul>
<p>阈值的模式有两种选择</p>
<ol>
<li><p>绝对值, 即按照标记的阈值数据进行比较</p>
</li>
<li><p>百分比, 阈值为相对于最大值的占比</p>
</li>
</ol>
<p>阈值展示的形式有四种：</p>
<ol>
<li><p>不展示 （off）</p>
</li>
<li><p>只展示阈值线 （as lines）</p>
</li>
<li><p>只展示区域 （as filled regions）</p>
</li>
<li><p>同时展示阈值线和区域 （as filled regions and lines）</p>
</li>
</ol>
<p>下图为我们选择绝对值模式下，展示线和区域的阈值示例图， 由图可以看出数据在不同阈值区间的分布，以及与阈值的对比，因此我们能直观的评估出数据的质量</p>
<p><img src="/image-68.png" alt="Alt text">            </p>
<h2 id="数值映射-Value-mappings"><a href="#数值映射-Value-mappings" class="headerlink" title="数值映射 (Value mappings)"></a>数值映射 (Value mappings)</h2><p>✦</p>
<p><img src="/image-69.png" alt="Alt text">            </p>
<p>图表的展示都是由许多的值来组成的一个个点，连线，反过来讲，图表就是数据值的展现，在图表中， 有时候有些数据并不是我们理想的数值，或者说我们想特异性的让某些值显示为其他值（写SQL语句也可以实现）， 这时候可以使用数值映射选项</p>
<p><img src="/image-70.png" alt="Alt text"></p>
<p>数值映射的形式可以有以下四种</p>
<p>1 单纯的某个值映射</p>
<ol start="2">
<li><p>一段范围区间映射</p>
</li>
<li><p>正则表达式映射</p>
</li>
<li><p>针对某类值映射</p>
</li>
</ol>
<p>例如在示例中，假如我们健康波段数据具体值不关心， 只是关心整体的数据波动范围是否在健康范围之内，我们可以把0~3000ms的范围映射为健康，那么再具体显示的时候，不再会有具体值给到我们，统一会展示健康，如下图：</p>
<p><img src="/image-71.png" alt="Alt text"></p>
<p>这个功能更加适用于表格数据，例如我们明确的将空数据映射为空或0的场景，如下图</p>
<p><img src="/image-72.png" alt="Alt text"></p>
<h2 id="数据覆盖-Overrides"><a href="#数据覆盖-Overrides" class="headerlink" title="数据覆盖 (Overrides)"></a>数据覆盖 (Overrides)</h2><p>✦</p>
<p>数据覆盖允许我们对之前已经设置好的图表进行个性化设置，它相当于图表更高级的设置，覆盖的范围可以是整个SQL语句获取的数据，也可以是数据中某一类图例数据</p>
<p><img src="/image-73.png" alt="Alt text">         </p>
<p>具体覆盖的数据类别：</p>
<p>1 某一类数据</p>
<ol start="2">
<li><p>正则匹配到的数据</p>
</li>
<li><p>某些类型的数据</p>
</li>
<li><p>整个SQL查询的数据</p>
</li>
</ol>
<p>在设置了一个Override 之后，就可以进一步进行子项的配置，子项里面的属性几乎与上文介绍的图表属性一致</p>
<p><img src="/image-74.png" alt="Alt text">          </p>
<p>我们通过覆盖属性的配置，可以让修改到之前我们已经在整体设置好的图标样式</p>
<p>例如我们现在经过SQL查询，已经获取到了js_ready和css_ready的耗时数据，但是我们想让这两种数据对比更加明确，既能够清晰的看到整体的趋势，也能看到某类数据单独的变化，这时我们可以通过override属性进行配置，让两个数据的纵坐标分别在左右两边，并且数据展示用折线和柱状图分别表示。</p>
<p>具体override配置属性如下图：</p>
<p><img src="/image-75.png" alt="Alt text">              </p>
<p>对css_ready 数据配置：</p>
<ol>
<li><p>图表展示为柱状图， 柱状图数据点居中</p>
</li>
<li><p>纵坐标数据靠右展示，颜色为浅绿色</p>
</li>
<li><p>标题设置为CSS耗时（ms）</p>
</li>
</ol>
<p>对js_ready数据配置：</p>
<ol>
<li><p>默认基础配置折线图</p>
</li>
<li><p>默认纵坐标靠左展示</p>
</li>
<li><p>设置颜色红色</p>
</li>
<li><p>标题设置为JS耗时（ms）</p>
</li>
</ol>
<p>最终结果如下图：<br><img src="/image-76.png" alt="Alt text"></p>
<h2 id="变量与模板"><a href="#变量与模板" class="headerlink" title="变量与模板"></a>变量与模板</h2><p>✦</p>
<p>在Grafana里面，学会使用变量，会发现打开了新世界的大门，用好变量，可能你的工作量就会缩减一半，甚至更多。</p>
<p>变量的使用场景有很多，例如我们编写SQL语句中的时间选项（$__interval），就是内置的一个变量，通过这个时间变量，可以控制多个图表在不同时间范围内的展示情况，因此一个好的变量的使用，可以让我们只配置一个图表，达到展示不同条件下的数据的目的，而不用去为每一种情况设置一个图表。</p>
<p>模板在Grafana中最简单的含义就是任何一条包含变量的查询（query)。</p>
<p>【变量的设置】</p>
<p>变量的设置是基于看板的，看板内设置的变量，对看板内的所有面板是共享的</p>
<p>点击看板设置，进入变量设置页面</p>
<p><img src="/image-77.png" alt="Alt text"></p>
<p><img src="/image-78.png" alt="Alt text">            </p>
<p>【变量的种类】</p>
<p> <img src="/image-79.png" alt="Alt text">              </p>
<p>在添加一个变量的可选下拉框中，可以选择添加的变量类型，共计有以下几种变量可以选择</p>
<table>
<thead>
<tr>
<th align="left">变量类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">query</td>
<td align="left">查询变量允许编写可以返回指标名称、标签值或键列表的数据源查询。例如，查询变量可能会返回服务器名称, ID 或数据中心的列表。变量值随着数据源查询动态获取选项而变化。</td>
</tr>
<tr>
<td align="left">custom</td>
<td align="left">手动定义变量选项,使用逗号分隔的列表</td>
</tr>
<tr>
<td align="left">text box</td>
<td align="left">显示具有可选默认值的自由文本输入字段</td>
</tr>
<tr>
<td align="left">constant</td>
<td align="left">设置一个常量</td>
</tr>
<tr>
<td align="left">data source</td>
<td align="left">快速添加一个数据源的变量</td>
</tr>
<tr>
<td align="left">interval</td>
<td align="left">代表时间跨度的变量</td>
</tr>
<tr>
<td align="left">ad hoc filters</td>
<td align="left">自动添加到数据源的所有指标查询的键&#x2F;值过滤器（仅限 InfluxDB、Prometheus 和 Elasticsearch）</td>
</tr>
</tbody></table>
<p>添加变量的其他输入框选项可以直接根据英文的意义非常直白的看出，例如设置面标签信息，描述信息，以及设置是否在看板中隐藏，对于某些变量类型还可以设置是否可以多选或者是否包含所有的值的选项等等，这些设置可以根据自己的需求来选择。</p>
<p>【变量的使用】</p>
<p>设置完成变量之后，变量的使用有两种形式</p>
<p>$varname， 这是最直接的方式， 但是这种语法会有限制，就是不能在一个词的中间使用例如：apps.frontend.$varname.requests.count</p>
<ol>
<li>${var_name}， 如果想要在表达式中间插入变量，请使用此语法，另外这种语法还有一些高级用法，${var_name:<format>}，这种格式可以更好地控制 Grafana 如何插入值，具体的用法可以参考官方文档</li>
</ol>
<p>【变量简单使用示例】</p>
<p>沿用上文的数据，我们创建一个简单的自定义变量，url_event,如下图</p>
<p><img src="/image-80.png" alt="Alt text"></p>
<p>获取数据的时候,sql 语法就可以写成如下</p>
<p><img src="/image-81.png" alt="Alt text"></p>
<p>这样，我们只建立了一个图表面板，由于使用了变量，因此可以只用变量的切换就实现看板数据的变化，如下</p>
<p>变量选择 js_ready<br><img src="/image-82.png" alt="Alt text"><br>变量选择css_ready</p>
<p><img src="/image-83.png" alt="Alt text"></p>
<h2 id="Link的使用"><a href="#Link的使用" class="headerlink" title="Link的使用"></a>Link的使用</h2><p>✦</p>
<p>在Grafana中，可以使用链接来进行看板的跳转以及外链的跳转，并且link的使用也非常灵活。</p>
<p>在一个数据面板的设置中，link可以的设置主要有两种方式</p>
<ol>
<li>整个面板设置链接</li>
</ol>
<p><img src="/image-84.png" alt="Alt text">              </p>
<p>在数据面板的设置中，前文我们没有细讲link的选项，这里其实是为整个数据面板设置跳转链接的入口，通过此处设置link，可以在面板上增加一个icon, 实现我们在点击的时候进行跳转, 具体效果如下图</p>
<p><img src="/image-85.png" alt="Alt text">              </p>
<ol start="2">
<li>为具体数据设置link(data links)</li>
</ol>
<p>data links属性设置一般只在柱状图、折线图、表格面板里才有，并且，如果没有搭配override属性进行个性化设置的话，默认每个数据点都会设置上跳转的链接，效果如下图</p>
<p><img src="/image-86.png" alt="Alt text"></p>
<p>这样的设置其实和整个面板设置link类似，因此不同的data links 最好和override属性搭配，来进行个性化的数据链接跳转，以达到不通数据跳转不同链接的目的。</p>
<h2 id="Link与变量的搭配"><a href="#Link与变量的搭配" class="headerlink" title="Link与变量的搭配"></a>Link与变量的搭配</h2><p>✦</p>
<p>Grafana的link设置非常灵活，在link设置中，可以直接使用已经设置的看板变量以及系统的变量来进行链接的组合。</p>
<p>甚至在data links的设置中，还可以直接使用SQL语句查询到的结果来进行链接的组合，这样也可达到不同数值设置不同的跳转链接的功能</p>
<p>在添加链接的时候，如果想查看可用变量列表，可以直接在数据链接URL字段中键入 $ 来查看变量列表，效果如下图：</p>
<p><img src="/image-87.png" alt="Alt text"></p>
<p>变量列表里的变量主要可以分为三个类型</p>
<p>a. 全局内建的变量，例如时间变量的 from, to</p>
<p>b. 用户创建的模板变量，例如上文示例创建的 url_event</p>
<p>c. 基于SQL语句查询出来的数据，一般都在fields字段下</p>
<p>通过引用变量来创建图表面板的跳转链接，可以较为灵活的实现基于数据的外链跳转以及更为高级的数据看板的之间的联动，下文要讲到的数据下钻就是基于data links 与变量的搭配来实现。</p>
<h1 id="Grafana高级使用"><a href="#Grafana高级使用" class="headerlink" title="Grafana高级使用"></a>Grafana高级使用</h1><h2 id="妙用Transform"><a href="#妙用Transform" class="headerlink" title="妙用Transform"></a>妙用Transform</h2><p>✦</p>
<p>前面讲的一些Grafana的使用，都是以SQL语句查询到的数据为基础，在图表可视化上进行的设置与操作，而Transform的功能，大部分是更底层的操作，直接对数据的操作，来达到改变图表展示的目的，是数据可视化之前的操作。</p>
<p>tranform 可以实现将我们查询到的数据进行进一步加工，例如可以进行数据筛选，计算，重命名，排序以及控制隐藏等功能。</p>
<p><img src="/image-88.png" alt="Alt text"></p>
<p>本文以几个较为典型的功能简单介绍一下</p>
<ol>
<li>通过计算添加数据（Add field from calculation）</li>
</ol>
<p><img src="/image-89.png" alt="Alt text">              </p>
<p>数据的计算有两种模式：</p>
<p>a. Reduce row： 分别对选择的特定字段数据的每一行进行聚合计算</p>
<p>b. Binary option： 选定的两个字段的值进行数学运算例如加减乘除</p>
<ol start="2">
<li>转换数据的类型(Convert field type)</li>
</ol>
<p>可以将选择的特定字段的值的类型指定为固定的数据类型</p>
<p><img src="/image-90.png" alt="Alt text">              </p>
<ol start="3">
<li>根据名称筛选数据展示(Filter data by name)</li>
</ol>
<p>a. 可以将SQL语句查询出的字段名称陈列，并且自定义数据的展示与否</p>
<p>b. 也可以直接根据正则表达式进行数据筛选</p>
<p><img src="/image-91.png" alt="Alt text"></p>
<ol start="4">
<li>数据合并（Merge）</li>
</ol>
<p>类似sql中的join，根据时间序列来进行合并不同的字段数据成为个数据表</p>
<p><img src="/image-92.png" alt="Alt text"></p>
<ol start="5">
<li>重命名（Rename by regex）</li>
</ol>
<p>可以使用这个功能来进行查询结果名称的转换，允许我们使用正则表达式来进行重命名内容的匹配</p>
<p><img src="/image-93.png" alt="Alt text">          </p>
<p>transform 还有很多实用的功能，这里就不一一陈列，如果有需要用到操作数据的功能，可以考虑transform功能，全部的功能可以直接看官方文档</p>
<h2 id="面板的Repeat"><a href="#面板的Repeat" class="headerlink" title="面板的Repeat"></a>面板的Repeat</h2><p>✦</p>
<p>面板的repeat 也是需要搭配变量功能来使用，图表面板会根据用户选择的变量个数来进行分别加载，因此，此功能使用的前提是变量的值要大于1个，并且设置了允许多个变量可选，见下图示例</p>
<p><img src="/image-94.png" alt="Alt text"></p>
<p>当前提条件满足后，可以在面板的repeat属性进行设置</p>
<p>repeat 可选加载的方向是横向还是纵向，并且可以设置最大的重复个数，来避免造成加载展示问题以及性能问题。</p>
<p>当设置完成后，并不会马上生效，需要保存然后退出此图表面板然后重新加载一下数据看板，然后数据图表就会根据我们选择的变量的个数来进行分别的展示。</p>
<p>以上文的示例设置之后，效果如图：</p>
<p><img src="/image-95.png" alt="Alt text"></p>
<h2 id="数据下钻"><a href="#数据下钻" class="headerlink" title="数据下钻"></a>数据下钻</h2><p>✦</p>
<p>要实现一个数据下钻，需要link搭配变量来进行看板之间的联动，主要的思路大体如下：</p>
<ol>
<li><p>模板看板B中设置好需要的变量</p>
</li>
<li><p>模板看板B查询数据时引用变量</p>
</li>
<li><p>在源图表面板A中设置跳转到模板看板B的链接，链接上引用我们设置或者是查询的变量内容</p>
</li>
<li><p>跳转至目标模板数据看板B时，模板看板B获取从link上带过来的变量值</p>
</li>
<li><p>变量赋值，模板看板B根据变量值刷新数据查询</p>
</li>
</ol>
<p>经过上面的步骤，那么一个数据看板之间的联动就完成了，剩下的步骤就是丰富变量的设置以及看板内图表面板的内容了。</p>
<p>那么如何从跳转过来的link上获取到携带过来的变量的值呢？</p>
<p>在上文我们设置变量来控制数据面板repeat的时候，我们设置了一个变量 url_event</p>
<p>当控制变量为 js_ready的时候，看板的整体URL是</p>
<p><img src="/image-96.png" alt="Alt text"></p>
<p>当控制变量为 css_ready的时候，看板的整体URL是</p>
<p><img src="/image-97.png" alt="Alt text"></p>
<p>因此我们可以看到，当我们看板设置变量并且使用的时候，变量的内容是以query的格式显示在URL上的，并且命名的格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var-&#123;your_var_name&#125; = &#123;your_var_value&#125;</span><br></pre></td></tr></table></figure>

<p>当变量在url上面显式的标记的时候，Grafana会主动获取链接上面声明的变量的值并赋值给模板变量。</p>
<p>因此根据上面的格式，我们可以在link上面构造上述的数据query格式，为模板的看板变量赋值。</p>
<p>于是实现一个的数据下钻整体流程都变得清晰了，下面我们还是以上文的例子来构造一个简单的数据下钻的例子</p>
<ol>
<li>构造一个整体的page render 数据看板 A</li>
</ol>
<p>将数据格式以table的形式展现，整体性的展示当天项目的render过程的各个事件平均耗时情况，如下图：</p>
<p><img src="/image-98.png" alt="Alt text"></p>
<ol start="2">
<li>设置一个详细指标数据的模板看板 B</li>
</ol>
<p>新建另一个数据详情的看板，然后建立一个事件的变量</p>
<p><img src="/image-99.png" alt="Alt text"></p>
<p>编写具体事件详细数据的查询SQL语句，并引用变量</p>
<p><img src="/image-100.png" alt="Alt text"></p>
<ol start="3">
<li>通过link实现看板之间的联动</li>
</ol>
<p>配置数据看板A的data link, 使得每一行数据可以进行下钻详情展示</p>
<p><img src="/image-101.png" alt="Alt text"></p>
<p>经过上述步骤，就完成可一个简单的数据下钻，实现可一个项目page render过程的整体数据的可视化，并且可以点击具体加载事件查看该事件详细的数据分布趋势</p>
<p>效果如下:<br><img src="/image-103.png" alt="Alt text"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Grafana是一款非常优秀的开源可视化工具，能非常方便的将数据进行可视化，非常适合数据大盘建设，以及做数据监控和数据统计的工作。</p>
<p>本文基于实际业务中建设监控数据大盘的经验，介绍了Grafana基本的一些图表概念和使用方法，并对不同的数据类型选取合适的可视化图表提供了一些建议和思考。</p>
<p>通过三个阶段的介绍，总结了Grafana进行数据可视化入门教程以及一些进阶使用技巧，希望能在未来你的业务中，数据大盘的建设过程中提供一些便利和思路。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://wongearl.github.io">Earl Wong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wongearl.github.io/2023/10/31/kubernetes/grafana-dashboard/">https://wongearl.github.io/2023/10/31/kubernetes/grafana-dashboard/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wongearl.github.io" target="_blank">Earl Wong</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/grafana/">grafana</a></div><div class="post_share"><div class="social-share" data-image="/img/20230818103122.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/02/kubernetes/kube-ovn-underlay/" title="kubeovn underlay 相关概念"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">kubeovn underlay 相关概念</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/27/linux/chrony/" title="chrony参数及常用命令介绍"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">chrony参数及常用命令介绍</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/08/31/kubernetes/grafana-create-alert-rule/" title="grafana how to create alert rule"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-31</div><div class="title">grafana how to create alert rule</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/20230818103122.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Earl Wong</div><div class="author-info__description">Share everything</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wongearl"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wongearl" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:earlwong368@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%9B%BE%E8%A1%A8"><span class="toc-number">2.</span> <span class="toc-text">数据与图表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%8A%98%E7%BA%BF%E5%9B%BE"><span class="toc-number">2.1.</span> <span class="toc-text">1. 折线图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%9F%B1%E7%8A%B6%E5%9B%BE"><span class="toc-number">2.2.</span> <span class="toc-text">2. 柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%82%B9%E7%8A%B6%E5%9B%BE"><span class="toc-number">2.3.</span> <span class="toc-text">3. 点状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%A5%BC%E7%8A%B6%E5%9B%BE"><span class="toc-number">2.4.</span> <span class="toc-text">4. 饼状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%8D%95%E4%B8%80%E7%8A%B6%E6%80%81%E5%9B%BE"><span class="toc-number">2.5.</span> <span class="toc-text">5. 单一状态图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%BB%AA%E8%A1%A8%E7%9B%98"><span class="toc-number">2.6.</span> <span class="toc-text">6. 仪表盘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%A1%A8%E6%A0%BC"><span class="toc-number">2.7.</span> <span class="toc-text">7. 表格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E6%96%87%E6%9C%AC"><span class="toc-number">2.8.</span> <span class="toc-text">8. 文本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E2%80%A6"><span class="toc-number">2.9.</span> <span class="toc-text">9. …</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%9B%BE%E8%A1%A8%E7%9A%84%E6%90%AD%E9%85%8D"><span class="toc-number">3.</span> <span class="toc-text">数据与图表的搭配</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%BA%E5%88%86"><span class="toc-number">3.1.</span> <span class="toc-text">按照数据格式区分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E4%BD%BF%E7%94%A8%E6%84%8F%E5%9B%BE%E5%8C%BA%E5%88%86"><span class="toc-number">3.2.</span> <span class="toc-text">按照使用意图区分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96-%E2%9C%A6"><span class="toc-number">3.3.</span> <span class="toc-text">其他      ✦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%9B%BE%E8%A1%A8%E7%9A%84%E6%B7%BB%E5%8A%A0%E4%B8%8E%E6%89%A9%E5%B1%95"><span class="toc-number">3.4.</span> <span class="toc-text">数据与图表的添加与扩展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E6%B7%BB%E5%8A%A0"><span class="toc-number">3.5.</span> <span class="toc-text">数据源添加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E8%A1%A8%E6%8F%92%E4%BB%B6%E6%B7%BB%E5%8A%A0"><span class="toc-number">3.6.</span> <span class="toc-text">图表插件添加</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Grafana%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">Grafana入门使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%9C%8B%E6%9D%BF-dashboard"><span class="toc-number">4.1.</span> <span class="toc-text">创建一个看板 (dashboard)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%9D%A2%E6%9D%BF-panel"><span class="toc-number">4.2.</span> <span class="toc-text">创建面板 (panel)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E6%9D%BF%E6%95%B0%E6%8D%AE%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-number">4.3.</span> <span class="toc-text">面板数据的获取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">4.4.</span> <span class="toc-text">面板的基础配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Grafana%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">Grafana进阶使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E8%A1%A8%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE-Standard-options"><span class="toc-number">5.1.</span> <span class="toc-text">图表属性配置 (Standard options)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%88%E5%80%BC%E8%AE%BE%E7%BD%AE-Thresholds"><span class="toc-number">5.2.</span> <span class="toc-text">阈值设置 (Thresholds)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E6%98%A0%E5%B0%84-Value-mappings"><span class="toc-number">5.3.</span> <span class="toc-text">数值映射 (Value mappings)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%A6%86%E7%9B%96-Overrides"><span class="toc-number">5.4.</span> <span class="toc-text">数据覆盖 (Overrides)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E4%B8%8E%E6%A8%A1%E6%9D%BF"><span class="toc-number">5.5.</span> <span class="toc-text">变量与模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Link%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">5.6.</span> <span class="toc-text">Link的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Link%E4%B8%8E%E5%8F%98%E9%87%8F%E7%9A%84%E6%90%AD%E9%85%8D"><span class="toc-number">5.7.</span> <span class="toc-text">Link与变量的搭配</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Grafana%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">Grafana高级使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%99%E7%94%A8Transform"><span class="toc-number">6.1.</span> <span class="toc-text">妙用Transform</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E6%9D%BF%E7%9A%84Repeat"><span class="toc-number">6.2.</span> <span class="toc-text">面板的Repeat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%8B%E9%92%BB"><span class="toc-number">6.3.</span> <span class="toc-text">数据下钻</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">6.4.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/17/gitops/argo-cd-guide/" title="argo-cd-guide">argo-cd-guide</a><time datetime="2023-11-17T01:39:03.000Z" title="发表于 2023-11-17 09:39:03">2023-11-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/17/gitops/argo-workflow-guide/" title="argo-workflows-guide">argo-workflows-guide</a><time datetime="2023-11-17T01:33:50.000Z" title="发表于 2023-11-17 09:33:50">2023-11-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/15/golang/goland_code_rule/" title="如何真正写好Golang代码?">如何真正写好Golang代码?</a><time datetime="2023-11-15T01:38:47.000Z" title="发表于 2023-11-15 09:38:47">2023-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/13/%E4%BA%BA%E7%94%9F%E6%84%9F%E6%82%9F/%E4%BA%BA%E7%94%9F%E6%84%9F%E6%82%9F/" title="人生感悟">人生感悟</a><time datetime="2023-11-13T06:58:59.000Z" title="发表于 2023-11-13 14:58:59">2023-11-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/09/kubernetes/promql/" title="PromQL全解析">PromQL全解析</a><time datetime="2023-11-09T02:15:00.000Z" title="发表于 2023-11-09 10:15:00">2023-11-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Earl Wong</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>